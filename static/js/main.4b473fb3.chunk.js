(this.webpackJsonpcards=this.webpackJsonpcards||[]).push([[0],{44:function(e,t,c){},51:function(e,t,c){},55:function(e,t,c){},56:function(e,t,c){"use strict";c.r(t);var n=c(4),a=c.n(n),r=c(34),s=c.n(r),o=c(20),i=c(8),l=(c(44),c(2));function u(){return Object(l.jsxs)("div",{className:"header",children:[Object(l.jsx)("div",{className:"header-link",children:Object(l.jsx)(o.b,{to:"/",children:"HOME"})}),Object(l.jsx)("div",{className:"header-link",children:Object(l.jsx)(o.b,{to:"/speed",children:"SPEED"})})]})}function d(){return Object(l.jsxs)("div",{children:[Object(l.jsx)(u,{}),Object(l.jsx)(j,{})]})}function j(){return Object(l.jsxs)("div",{className:"front",children:[Object(l.jsx)("img",{src:"svg/3-H.svg",className:"front-card-1 front-card"}),Object(l.jsx)("img",{src:"svg/A-S.svg",className:"front-card-2 front-card"}),Array(4).fill(0).map((function(e,t){return Object(l.jsx)("div",{className:"cards-back",style:{top:"calc(50% - ".concat(225-150*t,"px)"),left:"calc(35% - ".concat(150-100*t,"px)")},children:"CARDS"},t)})),Object(l.jsx)("div",{className:"cards-title",children:"CARDS"})]})}var f=c(36),p=c(38),b=c(39),h=c(37),O=c(22),m=c(24),v=c(25),k=c(17),x=c.n(k),E=c(26),g=c(15),A=(c(51),c(31));A.a.initializeApp({apiKey:"AIzaSyC2k_ziySptS7pmqJqwImAJ4d0kyraRG2U",authDomain:"games-ff9af.firebaseapp.com",databaseURL:"https://games-ff9af.firebaseio.com",projectId:"games-ff9af",storageBucket:"games-ff9af.appspot.com",messagingSenderId:"218160036645",appId:"1:218160036645:web:0fe8c2d8ca95709841f8cc",measurementId:"G-RM6TD3CLBM"});var S=A.a.firestore();function N(e){var t=e.location.search.replace(/\?/g,"");return t.length<1?function(e){var t=Object(n.useState)(""),c=Object(g.a)(t,2),a=c[0],r=c[1],s=Object(n.useState)(!1),o=Object(g.a)(s,2),i=o[0],d=o[1],j=Object(l.jsx)(T,{setVal:r});if(i)return Object(l.jsxs)("div",{children:[Object(l.jsx)(u,{}),Object(l.jsx)("div",{className:"speed-reg",children:"Loading..."})]});return Object(l.jsxs)("div",{children:[Object(l.jsx)(u,{}),Array(4).fill(0).map((function(e,t){return Object(l.jsx)("div",{className:"cards-back front",style:{left:"calc(50% - ".concat(100*(t-1.5),"px)"),top:"calc(30% - ".concat(100*(t-1.5),"px)")},children:"SPEED"})})),Object(l.jsx)("div",{className:"speed-title front",children:"SPEED"}),j,Object(l.jsx)("button",{className:"speed-join speed-button",onClick:function(){console.log(a),window.location.href=window.location.href.replace(/\?/g,"")+"?"+a},children:"JOIN"}),Object(l.jsx)("button",{className:"speed-create speed-button",onClick:Object(E.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,D();case 3:t=e.sent,window.location.href=window.location.href.replace(/\?/g,"")+"?"+t;case 5:case"end":return e.stop()}}),e)}))),children:"CREATE"})]})}():Object(l.jsxs)("div",{children:[Object(l.jsx)(u,{}),Object(l.jsx)(R,{code:t})]})}function T(e){var t=e.setVal;return Object(l.jsx)("input",{className:"speed-input",placeholder:"Game ID",onChange:function(e){t(e.target.value)}})}var w=function(){function e(t,c){Object(m.a)(this,e),this.num=t,this.suit=c}return Object(v.a)(e,[{key:"toString",value:function(){return e.cardstr(this.num)+"-"+e.suitstr(this.suit)}},{key:"toNumString",value:function(){return this.num+"-"+this.suit}}],[{key:"cardstr",value:function(e){return["A","2","3","4","5","6","7","8","9","10","J","Q","K"][e]}},{key:"suitstr",value:function(e){return["C","D","H","S"][e]}},{key:"parseStr",value:function(t){return new e(parseInt(t.split("-")[0]),parseInt(t.split("-")[1]))}}]),e}(),C=function(){function e(){Object(m.a)(this,e),this.stack=[]}return Object(v.a)(e,[{key:"addTop",value:function(e){this.stack=[e].concat(Object(O.a)(this.stack))}},{key:"addBottom",value:function(e){this.stack=[].concat(Object(O.a)(this.stack),[e])}},{key:"drawTop",value:function(){return this.stack.shift()}},{key:"drawBottom",value:function(){return this.stack.pop()}},{key:"empty",value:function(){return 0==this.stack.length}},{key:"peekTop",value:function(){return this.stack[0]}},{key:"peekBottom",value:function(){return this.stack[this.stack.length-1]}},{key:"shuffle",value:function(){for(var e=0;e<this.stack.length;e++){var t=Math.floor(Math.random()*this.stack.length),c=[this.stack[t],this.stack[e]];this.stack[e]=c[0],this.stack[t]=c[1]}}},{key:"size",value:function(){return this.stack.length}},{key:"remove",value:function(e){var t=this.stack[e];return this.stack=[].concat(Object(O.a)(this.stack.slice(0,e)),Object(O.a)(this.stack.slice(e+1))),t}},{key:"peek",value:function(e){return this.stack[e]}},{key:"replace",value:function(e,t){this.stack[e]=t}}]),e}(),y=function(e){Object(b.a)(c,e);var t=Object(h.a)(c);function c(e){var n;if(Object(m.a)(this,c),n=t.call(this),e)n.stack=e.split(",").map((function(e){return w.parseStr(e)}));else{for(var a=0;a<13;a++)for(var r=0;r<4;r++)n.stack.push(new w(a,r));n.shuffle()}return n}return Object(v.a)(c,[{key:"toString",value:function(){return this.stack.map((function(e){return e.toNumString()})).join(",")}}]),c}(C);function D(){return P.apply(this,arguments)}function P(){return(P=Object(E.a)(x.a.mark((function e(){var t,c,n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return new y,t={TYPE:"SPEED",DECK0:(new y).toString(),DECK1:(new y).toString(),DOUBLES:!0,JOINED0:!1,JOINED1:!1},e.next=4,S.collection("Cards").add(t);case 4:c=e.sent,n=0;case 6:if(!(n<2)){e.next=19;break}a=0;case 8:if(!(a<5)){e.next=14;break}return e.next=11,c.collection("MOVES").add({TYPE:"DRAW",PLAYER:n,TIMESTAMP:Date.now()});case 11:a++,e.next=8;break;case 14:return e.next=16,c.collection("MOVES").add({TYPE:"STACKDRAW",STACK:n,CARD:(new y).drawTop().toNumString(),TIMESTAMP:Date.now()});case 16:n++,e.next=6;break;case 19:return e.abrupt("return",c.id);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){var t=e.code,c=Object(n.useState)({ready:!1}),a=Object(g.a)(c,2),r=a[0],s=a[1],o=Object(n.useState)([]),i=Object(g.a)(o,2),u=i[0],d=i[1],j=Object(n.useState)(-1),b=Object(g.a)(j,2),h=b[0],O=b[1],m=Object(n.useState)({PLAYER:0,CONNECTED:!1}),v=Object(g.a)(m,2),k=v[0],A=v[1],N=k.PLAYER,T=Object(n.useState)(!1),D=Object(g.a)(T,2),P=D[0],R=D[1],I=t,M=[new y(r.DECK0),new y(r.DECK1)],L=[new C,new C],K=[new C,new C];if(Object(n.useEffect)((function(){S.collection("Cards").doc(I).get().then(function(){var e=Object(E.a)(x.a.mark((function e(t){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.exists||R(!0),console.log("RESETTING"),c=0,t.data().JOINED0?t.data().JOINED1?c=2:(c=1,S.collection("Cards").doc(I).update({JOINED1:!0})):(c=0,S.collection("Cards").doc(I).update({JOINED0:!0})),console.log("GOOD!"),A({CONNECTED:!0,PLAYER:c}),console.log("GOOD PAST!"),console.log(k);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){R(!0)}))}),[]),Object(n.useEffect)((function(){var e=S.collection("Cards").doc(I).onSnapshot((function(e){s(Object(p.a)({ready:!0},e.data())),console.log("READY!")}));return function(){return e()}}),[]),Object(n.useEffect)((function(){var e=S.collection("Cards").doc(I).collection("MOVES").onSnapshot((function(e){var t=e.docs.map((function(e){return e.data()}));t=t.sort((function(e,t){return e.TIMESTAMP-t.TIMESTAMP})),console.log("#2"),d(t)}));return function(){return e()}}),[]),P)return Object(l.jsxs)("div",{className:"speed-reg",children:["What have you done child ",Object(l.jsx)("br",{})," The game ID you entered wasn't found!"]});if(!k.CONNECTED)return Object(l.jsx)("div",{className:"speed-reg",children:"Loading..."});console.log(k);var B,J=!1,z=-1,V=0,G=Object(f.a)(u);try{for(G.s();!(B=G.n()).done;){var W=B.value;if("DRAW"===W.TYPE?L[W.PLAYER].addBottom(M[W.PLAYER].drawTop()):"STACKDRAW"===W.TYPE?K[W.STACK].addTop(w.parseStr(W.CARD)):"MOVE"===W.TYPE?(K[W.STACK].addTop(L[W.PLAYER].peek(W.CARD)),M[W.PLAYER].empty()?L[W.PLAYER].remove(W.CARD):L[W.PLAYER].replace(W.CARD,M[W.PLAYER].drawTop())):"FLIP"===W.TYPE&&(K[0].addTop(w.parseStr(W.CARD1)),K[1].addTop(w.parseStr(W.CARD2))),!(++V<12)){for(var H=0;H<2;H++)0===L[H].size()&&(J=!0,z=H);if(J)break}}}catch(Z){G.e(Z)}finally{G.f()}var U=function(e,t){return Math.abs(e.num-t.num)<=1||Math.abs(e.num+13-t.num)<=1||Math.abs(e.num-t.num-13)<=1},q=function(e){for(var t=!1,c=0;c<2;c++)for(var n=0;n<L[c].size();n++)U(e,L[c].peek(n))&&(t=!0);return t};if(r.ready&&u.length>0){if(!r.JOINED1)return Object(l.jsxs)("div",{className:"waiting",children:["Wait for someone to join! ",Object(l.jsx)("br",{}),"The Game ID is ",I,", or just send them the link ",Object(l.jsx)("br",{})," ",window.location.href," ",Object(l.jsx)("br",{}),"You are Player 1, and once Player 2 joins, the game will instantly start. ",Object(l.jsx)("br",{}),"You cannot rejoin after leaving or reloading!"]});if(z>=0||2===N){var F=2===N?0:N;return Object(l.jsxs)("div",{className:"board",children:[Object(l.jsx)(Y,{card:"BACK",top:"50%",left:"72.5%"})," ",Object(l.jsx)(Y,{card:"BACK",top:"50%",left:"27.5%"})," ",Array(2).fill(0).map((function(e,t){return Object(l.jsx)(Y,{card:K[t].peekTop().toString(),top:"50%",left:"".concat(42.5+15*t,"%")},t)})),L[F].stack.map((function(e,t){return Object(l.jsx)(Y,{card:e.toString(),top:"80%",left:"".concat(25+12.5*t,"%")},t)})),L[1-F].stack.map((function(e,t){return Object(l.jsx)(Y,{card:e.toString(),top:"20%",left:"".concat(25+12.5*t,"%")},t)})),Object(l.jsxs)("div",{className:"me",children:["PLAYER ",F+1]}),Object(l.jsx)("div",{className:"me-num",children:M[F].size()}),Object(l.jsxs)("div",{className:"them",children:["PLAYER ",1-F+1]}),Object(l.jsx)("div",{className:"them-num",children:M[1-F].size()}),Object(l.jsx)("div",{className:"you",children:N>=2?"You are spectating":"You are Player ".concat(N+1)}),z>=0?Object(l.jsxs)("div",{className:"winner",children:["WINNER: PLAYER ",z+1]}):""]})}if(!function(){for(var e=!1,t=0;t<2;t++)for(var c=0;c<L[t].size();c++)for(var n=0;n<2;n++)U(K[n].peekTop(),L[t].peek(c))&&(e=!0);return e}()&&0===N){console.log("Ruh roh, no move");var Q,_=new y;do{Q=_.drawTop()}while(!q(Q));var X=_.drawTop();S.collection("Cards").doc(I).collection("MOVES").add({TYPE:"FLIP",CARD1:Q.toNumString(),CARD2:X.toNumString(),TIMESTAMP:Date.now()})}return Object(l.jsxs)("div",{className:"board",children:[Object(l.jsx)(Y,{card:"BACK",top:"50%",left:"72.5%"})," ",Object(l.jsx)(Y,{card:"BACK",top:"50%",left:"27.5%"})," ",Array(2).fill(0).map((function(e,t){return Object(l.jsx)(Y,{card:K[t].peekTop().toString(),top:"50%",left:"".concat(42.5+15*t,"%"),onClick:function(){-1!==h&&function(e,t){var c=L[N].peek(e),n=K[t].peekTop();U(c,n)&&(S.collection("Cards").doc(I).collection("MOVES").add({PLAYER:N,CARD:e,STACK:t,TYPE:"MOVE",TIMESTAMP:Date.now()}),O(-1))}(h,t)}},t)})),L[N].stack.map((function(e,t){return Object(l.jsx)(Y,{card:e.toString(),top:"80%",left:"".concat(25+12.5*t,"%"),selected:t==h,onClick:function(){O(h!==t?t:-1)}},t)})),L[1-N].stack.map((function(e,t){return Object(l.jsx)(Y,{card:"BACK",top:"20%",left:"".concat(25+12.5*t,"%")},t)})),Object(l.jsxs)("div",{className:"me",children:["PLAYER ",N+1]}),Object(l.jsx)("div",{className:"me-num",children:M[N].size()}),Object(l.jsxs)("div",{className:"them",children:["PLAYER ",1-N+1]}),Object(l.jsx)("div",{className:"them-num",children:M[1-N].size()}),Object(l.jsxs)("div",{className:"you",children:[N>=2?"You are spectating":"You are Player ".concat(N+1)," ",Object(l.jsx)("br",{}),"Link to Spectate is ",window.location.href]})]})}return Object(l.jsx)("div",{className:"board speed-reg",children:"Loading..."})}function Y(e){return Object(l.jsx)("img",{src:"svg/".concat(e.card,".svg"),width:"10%",className:"speed-card"+(e.selected?" speed-card-selected":""),style:{top:e.top,left:e.left},onClick:e.onClick})}c(55);var I=function(){return Object(l.jsx)(o.a,{basename:"/",children:Object(l.jsxs)("div",{children:[Object(l.jsx)(i.a,{exact:!0,path:"/",component:d}),Object(l.jsx)(i.a,{path:"/speed",component:N})]})})};s.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(I,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.4b473fb3.chunk.js.map